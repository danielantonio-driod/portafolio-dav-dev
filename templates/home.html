{% extends 'base/base.html' %}
{% load static %}

{% block title %}Daniel Arrieta | Fullstack Developer + Django{% endblock %}

{% block content %}
    <section id="inicio">
        <h2>Desarrollador Fullstack + Django</h2>
        <p>Construyendo soluciones web desde Chile para el mundo con Django.</p>
        <div class="botones">
            {% if user.is_authenticated %}
                {% if user.userprofile.can_access_dashboard %}
                    <a href="{% url 'dashboard:dashboard_home' %}" class="boton">Dashboard</a>
                {% endif %}
                <a href="{% url 'orders:order_list' %}" class="boton">Ver Órdenes</a>
            {% else %}
                <a href="{% url 'register' %}" class="boton">Registrarse</a>
                <a href="{% url 'login' %}" class="boton">Iniciar Sesión</a>
            {% endif %}
            <a href="#contacto" class="boton">Contáctame</a>
        </div>
    </section>

    <section id="sobre-mi">
        <h2>Sobre mí</h2>
        <p>
            Apasionado por la tecnología, con experiencia real en mecánica, logística y desarrollo. 
            Me especializo en crear soluciones útiles para negocios reales usando Django y tecnologías modernas.
        </p>
        <div class="detalle">
            <h3>🚀 Nuevas Funcionalidades Django:</h3>
            <ul style="list-style: none; padding: 0; margin-top: 10px;">
                <li>✅ Sistema completo de autenticación y autorización</li>
                <li>✅ Dashboard administrativo con roles y permisos</li>
                <li>✅ Gestión de mensajes de contacto con estados</li>
                <li>✅ Sistema de órdenes con seguimiento completo</li>
                <li>✅ Panel de administración Django personalizado</li>
                <li>✅ Base de datos SQLite con modelos relacionales</li>
            </ul>
        </div>
    </section>

    <section id="proyectos">
        <h2>Proyectos</h2>
        <div class="carrusel-controles">
            <button onclick="moverCarrusel(-1)">&#9664;</button>
            <button onclick="moverCarrusel(1)">&#9654;</button>
        </div>
        
        <div class="proyecto">
            <h3>Portfolio Django - Sistema de Gestión</h3>
            <div class="detalle">
                <p><strong>Tecnologías:</strong> Django 5.2.7, SQLite, Bootstrap, JavaScript</p>
                <p><strong>Funcionalidades:</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>🔐 Autenticación con 4 roles: Admin, Manager, Staff, Customer</li>
                    <li>📝 Formularios Django con validación completa</li>
                    <li>📊 Dashboard con estadísticas en tiempo real</li>
                    <li>📋 Gestión de órdenes con estados y asignaciones</li>
                    <li>💬 Sistema de mensajes con prioridades</li>
                    <li>⚙️ Panel admin personalizado</li>
                </ul>
                <div style="margin-top: 15px;">
                    {% if user.is_authenticated %}
                        <a href="{% url 'dashboard:dashboard_home' %}" class="btn-django btn-primary">Ver Dashboard</a>
                    {% else %}
                        <a href="{% url 'login' %}" class="btn-django btn-primary">Acceder al Sistema</a>
                    {% endif %}
                    <a href="/admin/" class="btn-django btn-warning">Panel Admin</a>
                </div>
            </div>
        </div>
        
        <div class="proyecto">
            <h3>Informativo_Cyberguard</h3>
            <div class="detalle">
                <p><strong>Descripción:</strong> Página informativa de ciberseguridad.</p>
                <p><strong>Tecnologías:</strong> HTML5, CSS3, JavaScript</p>
                <a href="https://github.com/danielantonio-driod/m-dulo_2/tree/master/cyberguard" class="btn-django">Ver en GitHub</a>
            </div>
        </div>
        
        <div class="proyecto">
            <h3>Sistema de Contacto Django</h3>
            <div class="detalle">
                <p><strong>Características:</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>📧 Formulario con validación en tiempo real</li>
                    <li>🏷️ Sistema de prioridades (Baja, Media, Alta, Urgente)</li>
                    <li>📈 Estados de seguimiento (Nuevo, En Proceso, Resuelto)</li>
                    <li>🔍 Filtros y búsqueda avanzada</li>
                    <li>📱 Diseño responsivo</li>
                </ul>
                <a href="{% url 'contact:contact_form' %}" class="btn-django btn-success">Probar Formulario</a>
                {% if user.is_authenticated and user.userprofile.can_manage_messages %}
                    <a href="{% url 'contact:message_list' %}" class="btn-django">Gestionar Mensajes</a>
                {% endif %}
            </div>
        </div>
        
        <div class="proyecto">
            <h3>Sistema de Usuarios y Roles</h3>
            <div class="detalle">
                <p><strong>Funcionalidades:</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>👤 Perfiles de usuario extendidos</li>
                    <li>🛡️ Control de acceso basado en roles</li>
                    <li>📝 Registro de actividades del sistema</li>
                    <li>⚙️ Gestión de permisos granular</li>
                </ul>
                <p><strong>Usuarios Demo:</strong></p>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 8px;">
                    <div>Admin: admin/admin123</div>
                    <div>Manager: manager/manager123</div>
                    <div>Staff: staff/staff123</div>
                    <div>Cliente: cliente/cliente123</div>
                </div>
            </div>
        </div>
        
        <div class="proyecto">
            <h3>Próximos Proyectos</h3>
            <div class="detalle">
                <p><strong>En desarrollo:</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>🔄 API REST con Django REST Framework</li>
                    <li>📊 Dashboard con gráficos dinámicos</li>
                    <li>🔔 Sistema de notificaciones en tiempo real</li>
                    <li>📱 App móvil con React Native</li>
                    <li>☁️ Despliegue en la nube (AWS/Heroku)</li>
                </ul>
                <button class="btn-django" disabled>Próximamente</button>
            </div>
        </div>
    </section>

    <section id="contacto">
        <h2>Contacto Django</h2>
        <div class="detalle" style="margin-bottom: 20px;">
            <p><strong>🚀 Nuevo:</strong> Este formulario ahora usa el sistema Django con validación completa, 
            almacenamiento en base de datos y gestión administrativa.</p>
        </div>
        
        <form method="post" action="{% url 'contact:contact_form' %}">
            {% csrf_token %}
            <input type="text" name="name" placeholder="Tu nombre completo" required />
            <input type="email" name="email" placeholder="Tu correo electrónico" required />
            <input type="tel" name="phone" placeholder="Tu teléfono (opcional)" />
            <input type="text" name="subject" placeholder="Asunto del mensaje" required />
            
            <select name="priority" style="font-family: 'Press Start 2P', cursive; padding: 10px; border: 2px solid #000; font-size: 10px;">
                <option value="medium">Prioridad Media</option>
                <option value="low">Prioridad Baja</option>
                <option value="high">Prioridad Alta</option>
                <option value="urgent">Urgente</option>
            </select>
            
            <textarea name="message" placeholder="Tu mensaje (mínimo 10 caracteres)" required></textarea>
            
            <button type="submit">Enviar Mensaje Django</button>
        </form>
        
        {% if user.is_authenticated and user.userprofile.can_manage_messages %}
            <div style="margin-top: 20px; text-align: center;">
                <a href="{% url 'contact:message_list' %}" class="btn-django btn-primary">
                    Ver Todos los Mensajes (Admin)
                </a>
            </div>
        {% endif %}
    </section>

    <!-- Modal para proyectos -->
    <div id="modal" class="oculto modal">
        <div class="modal-contenido">
            <span class="cerrar" onclick="cerrarModal()">&times;</span>
            <h3 id="modal-titulo"></h3>
            <div id="modal-imagenes" class="galeria"></div>
            <p id="modal-descripcion"></p>
            <a id="modal-github" href="#" target="_blank" class="boton-github">Ver en GitHub</a>
        </div>
    </div>

    <!-- Botones flotantes -->
    <button id="btn-ir-arriba" onclick="scrollToTop()">↑</button>
    
    {% if not user.is_authenticated %}
        <a href="{% url 'login' %}" id="btn-contacto">Entrar</a>
    {% else %}
        <a href="{% url 'logout' %}" id="btn-contacto">Salir</a>
    {% endif %}
{% endblock %}

{% block extra_js %}
<script>
// Actualizar datos de proyectos para incluir información de Django
const proyectosData = [
    {
        titulo: 'Portfolio Django - Sistema Completo',
        descripcion: 'Sistema de gestión completo desarrollado con Django 5.2.7. Incluye autenticación, dashboard administrativo, gestión de mensajes y órdenes.',
        imagenes: [
            '{% static "img/django-dashboard.png" %}',
            '{% static "img/django-forms.png" %}',
            '{% static "img/django-admin.png" %}'
        ],
        repo: 'https://github.com/danielantonio-driod/portafolio-dav-dev'
    },
    {
        titulo: 'Informativo_Cyberguard',
        descripcion: 'Página informativa de ciberseguridad desarrollada con tecnologías web estándar.',
        imagenes: [
            '{% static "img/cg1.jpg" %}',
            '{% static "img/cg2.jpg" %}',
            '{% static "img/cg3.jpg" %}'
        ],
        repo: 'https://github.com/danielantonio-driod/m-dulo_2/tree/master/cyberguard'
    },
    {
        titulo: 'Sistema de Contacto Django',
        descripcion: 'Formulario de contacto completo con validación, almacenamiento en BD y gestión administrativa.',
        imagenes: [],
        repo: '#'
    },
    {
        titulo: 'Sistema de Usuarios y Roles',
        descripcion: 'Sistema completo de autenticación con 4 roles diferentes y control de acceso granular.',
        imagenes: [],
        repo: '#'
    },
    {
        titulo: 'Próximos Proyectos Django',
        descripcion: 'API REST, notificaciones en tiempo real, dashboard con gráficos y más funcionalidades.',
        imagenes: [],
        repo: '#'
    }
];

// Funcionalidad para mostrar mensajes de Django
{% if messages %}
    document.addEventListener('DOMContentLoaded', function() {
        {% for message in messages %}
            // Mostrar mensaje usando el estilo del portfolio
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert alert-{{ message.tags }}';
            alertDiv.innerHTML = '{{ message|escapejs }}';
            alertDiv.style.position = 'fixed';
            alertDiv.style.top = '100px';
            alertDiv.style.right = '20px';
            alertDiv.style.zIndex = '999';
            alertDiv.style.maxWidth = '300px';
            
            document.body.appendChild(alertDiv);
            
            // Auto-remove después de 5 segundos
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        {% endfor %}
    });
{% endif %}
</script>
{% endblock %}